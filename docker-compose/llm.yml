version: '3.8'

services:
  # ===== LLM CHALLENGE SERVICES =====
  # ===== VECTOR DATABASE FOR RAG =====
  qdrant:
    image: qdrant/qdrant:latest
    container_name: interview_qdrant
    ports:
      - "6333:6333"
      - "6334:6334"
    volumes:
      - qdrant_data:/qdrant/storage
    environment:
      QDRANT__SERVICE__HTTP_PORT: 6333
      QDRANT__SERVICE__GRPC_PORT: 6334
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:6333/health"]
      interval: 30s
      timeout: 10s
      retries: 3
    networks:
      - interview_network

  # ===== LOCAL LLM MODELS =====
  ollama:
    image: ollama/ollama:latest
    container_name: interview_ollama
    ports:
      - "11434:11434"
    volumes:
      - ollama_data:/root/.ollama
    environment:
      OLLAMA_HOST: 0.0.0.0
    networks:
      - interview_network

  # ===== FILE STORAGE =====
  minio:
    image: minio/minio:latest
    container_name: interview_minio
    environment:
      MINIO_ROOT_USER: minioadmin
      MINIO_ROOT_PASSWORD: minioadmin123
    ports:
      - "9000:9000"
      - "9001:9001"
    volumes:
      - minio_data:/data
    command: server /data --console-address ":9001"
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:9000/minio/health/live"]
      interval: 30s
      timeout: 20s
      retries: 3
    networks:
      - interview_network

  # ===== EMAIL TESTING FOR SENIOR FEATURES =====
  mailhog:
    image: mailhog/mailhog:latest
    container_name: interview_mailhog
    ports:
      - "1025:1025"
      - "8025:8025"
    networks:
      - interview_network

volumes:
  qdrant_data:
    driver: local
  ollama_data:
    driver: local
  minio_data:
    driver: local

networks:
  interview_network:
    external: true 